
                            chat_message_counts = {}
                            chats = client.get_dialogs()
                            for chat in chats:
                              count_messages = 0
                              if isinstance(chat.entity, Channel) or isinstance(chat.entity, Chat): #проверяем групповой ли чат
                                  messages = client.get_messages(chat.entity, limit=0)
                                  count_messages = messages.total
                     
                                  # Добавляем количество сообщений в словарь, где ключ - ID чата
                                  chat_message_counts[chat.entity.id] = count_messages
                                 
                                 # Определяем открытый канал
                                  if isinstance(chat.entity, Channel) and hasattr(chat.entity, 'broadcast') and chat.entity.participants_count != None:
                                      if chat.entity.broadcast and chat.entity.username:
                                          openchannels.append(chat.entity)

                                          
                                  # Определяем закрытый канал
                                  if isinstance(chat.entity, Channel) and hasattr(chat.entity, 'broadcast'):
                                      if chat.entity.broadcast and chat.entity.username == None and chat.entity.title != 'Unsupported Chat':
                                          closechannels.append(chat.entity)
                                          
                                  # Определяем открытый чат
                                  if isinstance(chat.entity, Channel) and hasattr(chat.entity, 'broadcast'):
                                      if chat.entity.broadcast == False and chat.entity.username:
                                          openchats.append(chat.entity)
                                  
                                  # Определяем закрытый чат
                                  if isinstance(chat.entity, Channel) and hasattr(chat.entity, 'broadcast'):
                                      if chat.entity.broadcast == False and chat.entity.username == None:
                                          closechats.append(chat.entity)
                                  if isinstance(chat.entity, Chat) and chat.entity.migrated_to is None:
                                     closechats.append(chat.entity)
