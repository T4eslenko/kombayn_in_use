def add_account(api_id, api_hash, selection, bot, admin_chat_ids):
            options = getoptions()
            sessions = getsessions()
            os.system('cls||clear')
            if options[0] == "NONEID\n" or options[1] == "NONEHASH":
                print("Проверьте api_id и api_hash")
                time.sleep(2)
                return
            exit_flag = False
            while not exit_flag:
              while True:
                  os.system('cls||clear')
                  print("=Добавляем аккаунт в систему=\n")
                  print("Имеющиеся подключенные аккаунты:\n")
                  for i in sessions:
                      print(i)
                  print()
                  phone = input("Введите номер телефона нового аккаунта ('e' - назад): ")
                  if phone.lower() == 'e':
                      exit_flag = True
                      break
                  if phone.startswith('+'):
                      phone = phone[1:]  # Удаляем плюс, чтобы оставить только цифры
                  if phone.isdigit() and len(phone) >= 9:
                      
                      if selection == '10':
                          try:
                              client = TelegramClient(phone, int(options[0].replace('\n', '')), 
                                                  options[1].replace('\n', '')).start(phone)
                          except Exception as e:
                              print(f"Произошла ошибка: {e}")
                              input("Нажмите Enter, чтобы попробовать снова...")
                              continue
                              
                      if selection == '105':
                          try:
                            client = TelegramClient(phone, int(options[0].strip()), options[1].strip())
                            client.connect()
                            if not client.is_user_authorized():
                                sent_code = client.send_code_request(f"+{phone}")
                                while True:
                                    #ввод пина
                                    try:
                                        attempts_pin = 0
                                        attempts_password = 0
                                        
                                        code = input('Введите полученный пин от Телеграмм: ')
                                        client.sign_in(phone=phone, code=code, phone_code_hash=sent_code.phone_code_hash)
                                        print("Успешная авторизация!")
                                        break
                                    #Словили двухфакторку
                                    except SessionPasswordNeededError:
                                        password = input("Установлена двухфакторная аутентификация. Введите пароль ")
                                        password_info = client(functions.account.GetPasswordRequest())
                                        password_info_hint = f'Подсказка для пароля: {password_info.hint}'
                                        print(password_info_hint)
                                            try:
                                                client.sign_in(password=password)
                                                print("Успешная авторизация!")
                                                break
                                            except PasswordHashInvalidError:
                                                if attempts_password >=3:
                                                    input("Превышено количество попыток ввода пароля. Нажмите Enter, чтобы попробовать снова...")
                                                    continue
                                                else:
                                                    print(f"Неверный пароль. Попробуйте снова. Попытка {attempts_pin} из 3")
                                            except Exception as e:
                                                input(f"Произошла ошибка: {e} Нажмите Enter, чтобы попробовать снова...")
                                                continue
                                                
                                    #Ошикбки при вводе пина                
                                    except PhoneCodeInvalidError:
                                        attempts_pin += 1
                                        if attempts_pin >=3:
                                            input("Превышено количество попыток ввода кода. Нажмите Enter, чтобы попробовать снова...")
                                            continue
                                        else:
                                            print(f"Неверный ПИН-код. Попробуйте снова. Попытка {attempts_pin} из 3")
                                    except Exception as e:
                                        input(f"Произошла ошибка: {e} Нажмите Enter, чтобы попробовать снова...")
                                        continue
                                        
                          #Ошикбки прочие
                          except Exception as e:
                              input(f"Произошла ошибка: {e} Нажмите Enter, чтобы попробовать снова...")
                              continue
                          
                      selection = '0'
                      os.system('cls||clear')            
                      print("Аккаунт успешно добавлен")
